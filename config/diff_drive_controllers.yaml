controller_manager:
  ros__parameters:
    update_rate: 100  # Hz
    use_sim_time: true

    # Diff Drive Controller
    diff_drive_controller:
      type: diff_drive_controller/DiffDriveController
      ros__parameters:
        # Wheel configuration
        left_wheel_names: ["left_wheel_joint"]
        right_wheel_names: ["right_wheel_joint"]
        wheel_separation: 0.35
        wheels_radius: 0.05
        
        # Frame IDs
        base_frame_id: "base_link"
        odom_frame_id: "odom"
        
        # Publishing configuration
        publish_rate: 50.0
        enable_odom_tf: true
        
        # Odometry covariance (uncertainty)
        pose_covariance_diagonal: [0.001, 0.001, 0.001, 0.001, 0.001, 0.01]
        twist_covariance_diagonal: [0.001, 0.001, 0.001, 0.001, 0.001, 0.01]
        
        # Velocity limits for safety
        linear:
          x:
            has_velocity_limits: true
            max_velocity: 0.5    # m/s
            min_velocity: -0.5   # m/s
            has_acceleration_limits: true
            max_acceleration: 1.0  # m/s²
        angular:
          z:
            has_velocity_limits: true
            max_velocity: 2.0    # rad/s
            min_velocity: -2.0   # rad/s
            has_acceleration_limits: true
            max_acceleration: 3.0  # rad/s²
        
        # Use modern ROS 2 control interface
        use_stamped_vel: false
        
        # Timeout for safety (stop if no commands received)
        cmd_vel_timeout: 0.5  # seconds

    # Joint State Broadcaster (publishes joint positions/velocities)
    joint_state_broadcaster:
      type: joint_state_broadcaster/JointStateBroadcaster